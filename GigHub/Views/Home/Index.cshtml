@model GigHub.ViewModels.GigsListingViewModel
@if (Model != null && Model.Gigs != null && Model.Gigs.Count() > 0)
{
    <table class="table table-striped">
        <thead>
            <tr>

                <th scope="col">Date Time</th>
                <th scope="col">Artist Name</th>
                <th scope="col">Genre</th>
                <th scope="col">Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var gig in Model.Gigs)
            {
            <tr>
                <td>
                    @gig.DateTime
                </td>
                <td>
                    @gig.Artist.Name
                </td>
                <td>
                    @gig.Genre.Name
                </td>
                <td>
                    <button data-gig-id="@gig.Id" class="btn btn-primary js-toggle-attendence">Going ?</button>
                </td>
            </tr>
            }
        </tbody>
    </table>
}
else
{
    <div class="alert alert-danger" role="alert">
        Sorry! NO Gigs exist.
    </div>
}
@section scripts
{
    
  <script>
      $(document).ready(function () {
          $(".js-toggle-attendence").click(function (e) {
              var button = $(e.target);
              $.post("/api/attendences", {gigId:button.attr("data-gig-id")})
                  .done(function () {
                      button.removeClass("btn-primary")
                          .addClass("btn-info").text("Going");

                  })
                  .fail(function () {
                      alert("Something Failed");
                  });
          });

      });
    </script>  
    
 }